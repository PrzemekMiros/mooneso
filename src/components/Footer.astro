---
import logo from "../assets/images/global/logo.png";
import cookieModalUrl from "../scripts/cookie-modal.js?url";
import contactFormUrl from "../scripts/contact-form.js?url";
import gsapUrl from "../scripts/libs/gsap.js?url";
import scrollTriggerUrl from "../scripts/libs/scroll-trigger.js?url";
import splitTextUrl from "../scripts/libs/split-text.js?url";
import gsapFlipUrl from "../scripts/libs/gsap-flip.js?url";
import lenisUrl from "../scripts/libs/lenis.js?url";
import animationsUrl from "../scripts/animations.js?url";
---

<footer class="relative pb-12 pt-24 font-sans">
  <div class="pointer-events-none absolute inset-y-0 left-1/2 w-screen -translate-x-1/2 bg-[#E0DED7]"></div>
  <div class="relative max-w-7xl mx-auto">
    
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-10 mb-6">
      <div>
        <h3 class="font-bold mb-6">Kontakt</h3>
        <div class="text-xs space-y-2 mb-6 leading-relaxed">
          <p>Przemek Miros</p>
          <p>kontakt@przemekmiros.pl</p>
          <p>+48 788 660 </p>
          <p>05-660 Warka</p>
        </div>
      </div>

      <div>
        <h3 class="font-bold mb-6">Nawigacja</h3>
        <ul class="text-xs space-y-3">
          <li><a href="/realizacje/" class="hover:text-white transition-colors" title="Realizacje">Realizacje</a></li>
          <li><a href="/artykuly/" class="hover:text-white transition-colors" title="Artykuły">Artykuły</a></li>
          <li><a href="/opinie/" class="hover:text-white transition-colors" title="O mnie">Opinie</a></li>
          <li><a href="/miasta/" class="hover:text-white transition-colors" title="O mnie">Miasta</a></li>
        </ul>
      </div>

      <div>
        <h3 class="font-bold mb-6">Social media</h3>
        <ul class="text-xs space-y-3">
          <li><a href="https://www.facebook.com/przemekstronyinternetowe" class="hover:text-white transition-colors" title="Facebook" target="_blank">Facebook</a></li>
          <li><a href="#https://www.behance.net/przemyslaw" class="hover:text-white transition-colors flex items-center gap-1" title="Behance" target="_blank">Behance <span class="text-[10px]">↗</span></a></li>
          <li><a href="https://github.com/PrzemekMiros" class="hover:text-white transition-colors flex items-center gap-1" title="Github">Github <span class="text-[10px]">↗</span></a></li>
          <li><a href="https://codepen.io/przemek-miros/" class="hover:text-white transition-colors" title="Codepen" target="_blank">Codepen <span class="text-[10px]">↗</span></a></li>
        </ul>
      </div>

      <div>
        <h3 class="font-bold mb-6">Narzędzia</h3>
        <ul class="text-xs space-y-3">
          <li><a href="https://www.senuto.com/pl/" class="hover:text-white transition-colors" title="Senuto">Senuto <span class="text-[10px]">↗</span></a></li>
          <li><a href="https://ahrefs.com/" class="hover:text-white transition-colors" title="Ahrefs">Ahrefs <span class="text-[10px]">↗</span></a></li>
          <li><a href="https://gemini.google.com/" class="hover:text-white transition-colors" title="Gemini">Gemini <span class="text-[10px]">↗</span></a></li>
          <li><a href="https://www.figma.com/" class="hover:text-white transition-colors" title="Figma">Figma <span class="text-[10px]">↗</span></a></li>
        </ul>
      </div>
    </div>

    <h6 class="text-[18vw] md:text-[9rem] lg:text-[12rem] xl:text-[17rem] text-center tracking-tighter text-black uppercase">
      Mooneso
    </h6>

    <div class="flex flex-col md:flex-row justify-between md:items-center border-t border-gray-400 pt-12 gap-6">
      <div class="flex flex-wrap justify-left gap-6 text-[11px]">
        <a href="#" class="hover:text-white transition-colors" title="Pliki cookies" data-cookie-open>Pliki cookies</a>
      </div>
    </div>
  </div>
</footer>

<div
  class="fixed inset-0 hidden bg-black/10 flex items-center justify-center z-[9999] p-4 font-sans text-left"
  data-cookie-modal
  aria-hidden="true"
  role="dialog"
  aria-modal="true"
  aria-labelledby="cookieconsent-title"
  tabindex="-1"
>
  <div class="bg-white rounded-lg shadow-2xl max-w-[600px] w-full overflow-hidden border border-gray-200">
    <div class="p-6 md:p-8 flex border-b border-gray-300">
      <div class="flex flex-col">
        <span id="cookieconsent-title" class="text-lg font-semibold text-gray-900 leading-tight">Strona używa plików cookie</span>
      </div>
    </div>

    <div class="px-6 md:px-8 flex border-b border-gray-300" role="tablist" aria-label="Cookie consent">
      <button class="flex-1 py-3 text-[var(--accent)] font-bold text-[11px] uppercase tracking-wider border-b-2 border-[var(--accent)] cursor-pointer" type="button" data-cookie-tab="consent" role="tab" id="cookie-tab-consent" aria-controls="cookie-panel-consent" aria-selected="true">
        Zgoda
      </button>
      <button class="flex-1 py-3 text-[var(--accent)] font-bold text-[11px] uppercase tracking-wider border-b-2 border-[var(--accent)] cursor-pointer text-[#00a3ff]" type="button" data-cookie-tab="details" role="tab" id="cookie-tab-details" aria-controls="cookie-panel-details" aria-selected="false">
        Szczegóły
      </button>
      <button class="flex-1 py-3 text-[var(--accent)] font-bold text-[11px] uppercase tracking-wider border-b-2 border-[var(--accent)] cursor-pointer text-[#00a3ff]" type="button" data-cookie-tab="about" role="tab" id="cookie-tab-about" aria-controls="cookie-panel-about" aria-selected="true">
        Info
      </button>
    </div>

    <div class="p-6 md:p-8" data-cookie-panel="consent" role="tabpanel" id="cookie-panel-consent" aria-labelledby="cookie-tab-consent">
      <p class="text-gray-600 text-[12px] leading-[1.6]">
        Strona używa plików cookie, aby personalizować treści, udostępniać funkcje mediów społecznościowych i analizować ruch. Udostępnia również informacje o tym, jak korzystasz z witryny, naszym partnerom społecznościowym, reklamowym i analitycznym.
      </p>
    </div>

    <div class="p-6 md:p-8 hidden" data-cookie-panel="details" role="tabpanel" id="cookie-panel-details" aria-labelledby="cookie-tab-details">
      <p class="text-gray-600 text-[12px] leading-[1.6] mb-4">
        Wybierz, na jakie kategorie plików cookie wyrażasz zgodę. Niezbędne są zawsze aktywne.
      </p>
      <div class="space-y-3 text-[12px] text-gray-700">
        <label class="flex items-center justify-between rounded border border-gray-200 px-3 py-2">
          <span>Niezbędne</span>
          <span class="flex items-center gap-2">
            <span class="text-[10px] uppercase tracking-wider text-gray-400">Zawsze aktywne</span>
            <input type="checkbox" checked disabled data-cookie-category="necessary" aria-label="Niezbędne" class="h-4 w-4 rounded border-gray-300 text-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)] disabled:cursor-not-allowed disabled:opacity-60" />
          </span>
        </label>
        <label class="flex items-center justify-between rounded border border-gray-200 px-3 py-2">
          <span>Funkcjonalne</span>
          <input type="checkbox" data-cookie-category="functional" aria-label="Funkcjonalne" class="h-4 w-4 rounded border-gray-300 text-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]" />
        </label>
        <label class="flex items-center justify-between rounded border border-gray-200 px-3 py-2">
          <span>Analityczne</span>
          <input type="checkbox" data-cookie-category="analytics" aria-label="Analityczne" class="h-4 w-4 rounded border-gray-300 text-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]" />
        </label>
        <label class="flex items-center justify-between rounded border border-gray-200 px-3 py-2">
          <span>Marketingowe</span>
          <input type="checkbox" data-cookie-category="marketing" aria-label="Marketingowe" class="h-4 w-4 rounded border-gray-300 text-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]" />
        </label>
      </div>
      <div class="mt-5">
        <button class="cursor-pointer w-full bg-[var(--accent)] text-white font-bold py-3 px-4 rounded-lg transition-colors text-[11px] uppercase tracking-wide" type="button" data-cookie-save>
          Zapisz ustawienia
        </button>
      </div>
    </div>

    <div class="p-6 md:p-8 hidden" data-cookie-panel="about" role="tabpanel" id="cookie-panel-about" aria-labelledby="cookie-tab-about">
      <p class="text-gray-600 text-[12px] leading-[1.6]">
        Pliki cookie to niewielkie informacje zapisywane w Twojej przeglądarce. Pomagają działać stronie,
        zapamiętywać ustawienia oraz mierzyć ruch. Możesz zmienić zgodę w każdej chwili w ustawieniach.
      </p>
    </div>

    <div class="p-6 md:p-8 pt-0 flex flex-col md:flex-row gap-2">
      <button class="cursor-pointer flex-1 bg-[var(--accent)] text-white font-bold py-3 px-4 rounded-lg transition-colors text-[11px] uppercase tracking-wide" type="button" data-cookie-deny>
        Odmów
      </button>
      <button class="cursor-pointer flex-1 bg-[var(--accent)] text-white font-bold py-3 px-4 rounded-lg transition-colors text-[11px] uppercase tracking-wide flex items-center justify-center gap-1" type="button" data-cookie-customize>
        Dostosuj
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"></path>
        </svg>
      </button>
      <button class="cursor-pointer flex-1 bg-[var(--accent)] text-white font-bold py-3 px-4 rounded-lg transition-colors text-[11px] uppercase tracking-wide" type="button" data-cookie-accept>
        Zezwól
      </button>
    </div>
  </div>
</div>

<div class="circle-container hidden md:flex items-center justify-center relative">
		<svg class="circle-progress svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
			<path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
		</svg>
    <svg class="h-4 w-4 text-white absolute top-4 left-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="var(--accent)">
      <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
    </svg>
</div>

<script>
document.addEventListener("astro:page-load", function () {
  const circleContainer = document.querySelector(".circle-container");
  if (!circleContainer) return;

  const offset = 50;
  const circlePath = document.querySelector(".circle-container path");
  const pathLength = circlePath.getTotalLength();

  circlePath.style.transition = circlePath.style.WebkitTransition = "none";
  circlePath.style.strokeDasharray = pathLength;
  circlePath.style.strokeDashoffset = pathLength;
  requestAnimationFrame(() => {
    requestAnimationFrame(() => {
      circlePath.style.transition = circlePath.style.WebkitTransition =
        "stroke-dashoffset 10ms linear";
    });
  });

  const updateLoader = () => {
    const scrollTop = window.scrollY;
    const docHeight = document.documentElement.scrollHeight;
    const winHeight = window.innerHeight;
    const height = Math.max(1, docHeight - winHeight);
    const progress = pathLength - (scrollTop * pathLength) / height;
    circlePath.style.strokeDashoffset = progress;

    if (scrollTop > offset) {
      circleContainer.classList.add("active");
    } else {
      circleContainer.classList.remove("active");
    }
  };

  let ticking = false;
  const onScroll = () => {
    if (ticking) return;
    ticking = true;
    requestAnimationFrame(() => {
      updateLoader();
      ticking = false;
    });
  };

  circleContainer.onclick = function () {
    window.scrollTo({ top: 0, behavior: "smooth" });
  };

  window.addEventListener("scroll", onScroll, { passive: true });
  updateLoader();
});
</script>

<script src={gsapUrl} defer></script>
<script src={scrollTriggerUrl} defer></script>
<script src={splitTextUrl} defer></script>
<script src={gsapFlipUrl} defer></script>
<script src={lenisUrl} defer></script>
<script src={animationsUrl} defer></script>
<script is:inline>
  document.addEventListener("astro:page-load", () => {
    if (typeof window.animationMain === "function") {
      window.animationMain();
    }
  });
</script>
<script src={cookieModalUrl} defer></script>
<script src={contactFormUrl} defer></script>

